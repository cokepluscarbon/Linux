#18.nslookup域名查询

###18.1 DNS域名服务器
`DNS`(Domain Name Server)叫`域名服务器`，是专门用于解析域名为IP地址的服务器。

`NDS`记录类型主要有：

####18.1.1 A记录
用来解析域名或子域名到IP地址的记录。例如将google.com解析为74.125.128.113。

####18.1.2 NS记录
用来指定域名服务器对域名进行解析的记录。例如将google.com的域名服务器指定为ns1.domain.com、ns2.domain.com等。

####18.1.3 MX记录
MX（Mail Exchanger）用来指定邮件服务器。例如发送邮件给`username@gmail.com`时，则查询DNS服务器的MX记录，如果MX记录存在，则发送邮件给指定的邮件服务器。

一个域可定义多个MX记录，每个记录都有不同的优先级，数字越小表示优先级越高。如果邮件通过第一优先级记录无法递送，则采用第二优先级，以此类推。

####18.1.4 CNAME记录
CNAME（Canonical Name）即规范名称记录，将一个别名关联到另一个真正的或规范的域名。例如，可以为www.example.com设置指向example.com的CNAME 记录。这样的话，当您在浏览器中输入 www.example.com 后，会被重定向到 example.com。同样地，也可以为mail.example.com设置指向example.com的CNAME记录。

####18.1.5 TXT记录
文本记录（也称TXT记录）是域名系统(DNS)中的资源记录，该记录可能包含任意文本，也可以用于定义可供机器读取的文本。 TXT 记录的最常见用途是验证域所有权并通过 SPF、DKIM 以及 DMARC 防止电子邮件滥用。TXT 记录是通过域名提供商保存的，因此必须通过提供商进行更改。

####18.1.6 AAAA记录
相当于IPv6版本的A记录。

####18.1.7 DNS配置示例
|名称/主机/别名   |	 记录类型	 |  值/应答/目标  |
|-----------------|------------|----------------|
|空白或 @	        | A	         | 216.239.32.21  |  
|空白或 @	        | A	         | 216.239.34.21  |
|空白或 @	        | A	         | 216.239.36.21  |
|空白或 @	        | A	         | 216.239.38.21  |
|空白或 @	        | MX	       | 1 ASPMX.L.GOOGLE.COM.  |
|空白或 @	        | MX	       |5 ALT1.ASPMX.L.GOOGLE.COM.  |
|空白或 @	        | MX	       | 5 ALT2.ASPMX.L.GOOGLE.COM.  |
|空白或 @	        | MX	       | 10 ASPMX2.GOOGLEMAIL.COM.  |
|空白或 @	        | MX	       | 10 ASPMX3.GOOGLEMAIL.COM.  |
|mail	            | CNAME	     | ghs.googlehosted.com.  |
|空白或 @	        | TXT	       | google-site-verification=6tTalLzrBXBO4Gy9700TAbpg2QTKzGYEuZ_Ls69jle8  |
|空白或 @	        | TXT	       | v=spf1 include:_spf.google.com ~all  |
|www	            | CNAME	     | ghs.googlehosted.com.  |

###18.2 nslookup命令
nslookup命令用于域名查询，在windows下和linux下的使用基本是一样的。例如

####18.2.1 基本用法
使用系统默认的DNS服务器解析allwinnertech.com：
```sql
root@kali:~# nslookup allwinnertech.com
Server:		202.96.128.86
Address:	202.96.128.86#53

Non-authoritative answer:
Name:	allwinnertech.com
Address: 114.112.59.213
```

####18.2.2 谷歌的DNS服务器8.8.8.8
使用谷歌的域名服务器解析allwinnertech.com:
```sql
root@kali:~# nslookup allwinnertech.com 8.8.8.8
Server:		8.8.8.8
Address:	8.8.8.8#53

Non-authoritative answer:
Name:	allwinnertech.com
Address: 114.112.59.213
```

####18.2.3 稍微高富帅的用法 
```sql
root@kali:~# nslookup
> server 8.8.8.8
Default server: 8.8.8.8
Address: 8.8.8.8#53
> allwinnertech.com
Server:		8.8.8.8
Address:	8.8.8.8#53

Non-authoritative answer:
Name:	allwinnertech.com
Address: 114.112.59.213
> set type=mx
> allwinnertech.com
Server:		8.8.8.8
Address:	8.8.8.8#53

Non-authoritative answer:
allwinnertech.com	mail exchanger = 5 mail.allwinnertech.com.

Authoritative answers can be found from:
> set type=ns
> allwinnertech.com
Server:		8.8.8.8
Address:	8.8.8.8#53

Non-authoritative answer:
allwinnertech.com	nameserver = ns4.dnsv3.com.
allwinnertech.com	nameserver = ns3.dnsv3.com.

Authoritative answers can be found from:
> set type=txt
> allwinnertech.com
Server:		8.8.8.8
Address:	8.8.8.8#53

Non-authoritative answer:
allwinnertech.com	text = "v=spf1 a mx ip4:221.4.213.95 mx:mail.allwinnertech.com ~all"

Authoritative answers can be found from:
> 
> set type=aaaa
> google.com
Server:		8.8.8.8
Address:	8.8.8.8#53

Non-authoritative answer:
google.com	has AAAA address 2404:6800:4005:803::1000

Authoritative answers can be found from:
> 

```

###18.3 参考资料
- <a href="https://support.google.com/a/answer/48090?hl=zh-Hans" target="_blank">https://support.google.com/a/answer/48090?hl=zh-Hans</a>
- 《Hacking with Kali》


